"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[891],{9890:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"module3","title":"Fireback Module3 Definition","description":"One of core features of Fireback framework, is that a lot of code is generated based on some yaml files.","source":"@site/docs/module3.md","sourceDirName":".","slug":"/module3","permalink":"/fireback/docs/docs/module3","draft":false,"unlisted":false,"editUrl":"https://github.com/torabian/fireback/tree/main/docs/docs/module3.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Download and install fireback","permalink":"/fireback/docs/docs/download-and-install-fireback"},"next":{"title":"Entities in Fireback","permalink":"/fireback/docs/docs/entities"}}');var i=t(4848),s=t(8453);const a={sidebar_position:2},r="Fireback Module3 Definition",d={},l=[{value:"Goal of the definition",id:"goal-of-the-definition",level:2},{value:"Contract in Module3",id:"contract-in-module3",level:2},{value:"Entities in Module3",id:"entities-in-module3",level:2},{value:"DistinctBy Feature on entities",id:"distinctby-feature-on-entities",level:2},{value:"Module3 Messages",id:"module3-messages",level:2},{value:"Define messages on the module:",id:"define-messages-on-the-module",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"fireback-module3-definition",children:"Fireback Module3 Definition"})}),"\n",(0,i.jsx)(n.p,{children:"One of core features of Fireback framework, is that a lot of code is generated based on some yaml files.\nBasically, fireback project consists of only these kind of modules, and generated code, slightly depends\non the fireback library version, but in the other hand we have tried to make it in a way that\ngenerated code is usuable without fireback, or in other words make it more explicit."}),"\n",(0,i.jsxs)(n.p,{children:["The thing is, the Fireback itself, is written with Fireback. Fireback original and important codebase is in\n",(0,i.jsx)(n.code,{children:"modules/workspaces"})," folder, which is Generated from ",(0,i.jsx)(n.code,{children:"modules/workspaces/WorkspaceModule3.yml"})]}),"\n",(0,i.jsx)(n.p,{children:"It took a long time before Fireback reaches to a stability that could be rewritten by itself."}),"\n",(0,i.jsxs)(n.p,{children:["Now in this document we will discuss about the Module3.yml files. When you create a new Fireback project,\nthe repository is configured to compile ",(0,i.jsx)(n.code,{children:"*Module3.yml"})," file ending. It's a convension in the Fireback ecosystem\nonly, you can configure this in other code editors. The general idea is something like code below:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'{\n    "match": "\\\\Module3.yml$",\n    "cmd": "${workspaceFolder}/artifacts/fireback/f gen gof --def ${relativeFile} --relative-to ${workspaceFolder} --gof-module github.com/torabian/fireback"\n},\n'})}),"\n",(0,i.jsx)(n.p,{children:'If you are using VSCode, this already exists but you need to install "Run on Save" plugin from extensions. At the\nmoment Fireback VSCode extension does not do this.'}),"\n",(0,i.jsx)(n.h2,{id:"goal-of-the-definition",children:"Goal of the definition"}),"\n",(0,i.jsx)(n.p,{children:"Fireback Module3 file format has a goal to contain as much as detail possible about a project. Up to version 1.1.27, Entities, Dtos, Actions, Remotes, Config, and few other important services are possible to be defined via these files."}),"\n",(0,i.jsx)(n.p,{children:"In fact, you could create Fireback modules and use them on a non Fireback project and it would work totally fine,\nyou might use only the definitions, structs, and helper codes which are generated, although this is not the goal of Fireback."}),"\n",(0,i.jsx)(n.h2,{id:"contract-in-module3",children:"Contract in Module3"}),"\n",(0,i.jsx)(n.p,{children:"Module3 format is standard YAML and can be modified by any yaml read/write library. You would\nwrite these module manually or using Fireback VSCode extension. Extension at 1.1.27\ndoes not fully support all features of Fireback Module3, therefor you need to learn it\nyour self."}),"\n",(0,i.jsx)(n.p,{children:"Common contracts on writing Module3 definitions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Everything is camelCase"}),"\n",(0,i.jsx)(n.li,{children:"Entity names is singular"}),"\n",(0,i.jsx)(n.li,{children:"array fields need to be plural"}),"\n",(0,i.jsx)(n.li,{children:"define all field types"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"entities-in-module3",children:"Entities in Module3"}),"\n",(0,i.jsx)(n.p,{children:"Entities, is a an array of entity in Fireback, which basically represents a table in database. Fireback entities\noffer more feature comparing to common ORMs, when they make entities. When you create an entity, it would\nalso create very common actions (CRUD, nested operations, array, ...) for you as well and make them a part\nof the http router and CLI. Also each entity, can define permissions on fields, or other kind of permissions\nand events related to them."}),"\n",(0,i.jsx)(n.p,{children:"When you define an entity, you often get most of things that you might need to manage them from a administration perspective, you need to create actions on top of them to add your business logic."}),"\n",(0,i.jsx)(n.h2,{id:"distinctby-feature-on-entities",children:"DistinctBy Feature on entities"}),"\n",(0,i.jsx)(n.p,{children:"In Fireback we allow some of entities to be unique, per specific workspace, user or some other conditions.\nThis is useful, when you want to make sure only one record per that condition exists on the database.\nFor example, you might want to have settings per user, but only per single user."}),"\n",(0,i.jsxs)(n.p,{children:["In such scenarios, you can define ",(0,i.jsx)(n.code,{children:"distinctBy"})," on the entity:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"entities:\n    - name: config\n      distinctBy: workspace\n      fields:\n      - name: title\n        type: string\n"})}),"\n",(0,i.jsx)(n.p,{children:"When you make it distinct by workspace, on the entity, WorkspaceId field becomes unique, therefor you cannot have multiple create on the same, and need to use update instead of create."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important"})," Make sure that the ",(0,i.jsx)(n.code,{children:"migration apply"})," has been called if the entity existed before. Migration for unique workspace Id might not occure via gorm migration (which Fireback is using underneath), so you might\nneed to manually migration add the unique constraint. For performance reasons, In 1.1.27 Fireback doesn't query\nand only relies on the constraint."]}),"\n",(0,i.jsx)(n.h2,{id:"module3-messages",children:"Module3 Messages"}),"\n",(0,i.jsx)(n.p,{children:"Messages, is a powerful yet simple feature of Fireback, which aims to organize the error messages across\nthe app. Often in many backends, we do not provide clear, translated error messages for actions."}),"\n",(0,i.jsx)(n.p,{children:"We recommend to add every possible error message that an backend (cli or http server) return into the module\ndefinition, and then translate them into different languages on the same place and give explanation."}),"\n",(0,i.jsx)(n.p,{children:"At the 1.1.27, you cannot extend them from another file, but I think it's useful to be able to keep translation\nof the error messages outside of the project, for those projects are having many languages, but maybe will be provided in later versions of Fireback."}),"\n",(0,i.jsx)(n.h3,{id:"define-messages-on-the-module",children:"Define messages on the module:"}),"\n",(0,i.jsx)(n.p,{children:"Messages are enums available in module level, they will become available for everything,\nthere for you need to put the messages of actions also in the the same object."}),"\n",(0,i.jsxs)(n.p,{children:["Entities support a field called ",(0,i.jsx)(n.code,{children:"messages"}),", and you can defined entity based messages as well\nfor more isolation."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"messages:\n  dataTypeDoesNotExistsInFireback:\n    en: This data type does not exist in fireback. %name %location\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When compiled, Fireback will create few objects in Golang which you could use later on (",(0,i.jsx)(n.code,{children:"WorkspacesModule.dyno.go"})," in this case)"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'...\nconst (\n\tAlreadyConfirmed                   workspacesCode = "AlreadyConfirmed"\n\tBodyIsMissing                      workspacesCode = "BodyIsMissing"\n\tDataTypeDoesNotExistsInFireback    workspacesCode = "DataTypeDoesNotExistsInFireback"\n...\n'})}),"\n",(0,i.jsx)(n.p,{children:"and Also:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'\nvar WorkspacesMessages = newWorkspacesMessageCode()\n\nfunc newWorkspacesMessageCode() *workspacesMsgs {\n\treturn &workspacesMsgs{\n\t\tDataTypeDoesNotExistsInFireback: ErrorItem{\n\t\t\t"$":  "DataTypeDoesNotExistsInFireback",\n\t\t\t"en": "This data type does not exist in fireback. %name %location",\n\t\t},\n'})}),"\n",(0,i.jsxs)(n.p,{children:["As you see, ",(0,i.jsx)(n.code,{children:"$"})," is the key of the error, which needs to be always present and is equal to uppercase of the key."]}),"\n",(0,i.jsxs)(n.p,{children:["Later on, in your actions or other go codes you can use when ",(0,i.jsx)(n.code,{children:"IError"})," is required:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"return Create401Error(&WorkspacesMessages.DataTypeDoesNotExistsInFireback, []string{})\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var o=t(6540);const i={},s=o.createContext(i);function a(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);